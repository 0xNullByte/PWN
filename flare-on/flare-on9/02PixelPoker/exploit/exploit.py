LOG = print
"""
    @Solve #1

        # jne_one
        # file_offset: 886
            00401486 | 0F 85 CA000000       | jne pixelpoker.401556    |

        # jne_two
        # file_offset: 89D
            0040149D | 0F 85 AB000000   | jne pixelpoker.40154E   |

    ---------------------------------------------------------

    @Solve # 2

    0040149B | 3BDA                     | cmp ebx,edx   |
                                                EDX = 313
    00401484 | 3BFA                     | cmp edi,edx   |
                                                EDI = 95


    (x, y)
    (95, 313)
   "PixelPoker (%d,%d)  95, 313"

"""
def exploit():
    jne_one = (16* 136) + 0x7
    jne_two = (16* 137) + 0xE
    f = bytearray(open("PixelPoker.exe", 'rb').read())


    LOG(f"[+] old value: jne_one: {f[jne_one]}, jne_two: {f[jne_two]}")
    f.pop(jne_one)
    f.pop(jne_two)
    LOG("[+] pop jne_one, jne_two from byte array")

    f.insert(jne_one, 0x84)
    f.insert(jne_two, 0x84)
    LOG("[+] insert jne_one, jne_two to bytearray")
    LOG(f"[+] new value: jne_one: {f[jne_one]}, jne_two: {f[jne_two]}")


    open("PixelPoker_patched.exe", 'wb').write(f)
    LOG("[+] file has been created: PixelPoker_patched.exe")
if __name__ == "__main__":
    exploit()
    # w1nN3r_W!NneR_cHick3n_d1nNer@flare-on.com
